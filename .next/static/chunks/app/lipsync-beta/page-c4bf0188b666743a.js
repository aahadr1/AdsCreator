(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[702],{403:function(e,s,l){Promise.resolve().then(l.bind(l,9200))},9200:function(e,s,l){"use strict";l.r(s),l.d(s,{default:function(){return n}});var a=l(7437);l(8877);var t=l(2265);function n(){let[e,s]=(0,t.useState)(null),[l,n]=(0,t.useState)(null),[i,r]=(0,t.useState)(null),[c,d]=(0,t.useState)(null),[o,u]=(0,t.useState)(null),[h,p]=(0,t.useState)("unknown"),[v,m]=(0,t.useState)([]),[f,x]=(0,t.useState)(!1),j=(0,t.useRef)(null),y=e=>m(s=>[...s,"".concat(new Date().toLocaleTimeString(),"  ").concat(e)]);async function N(){if(!e||!l)return!1;if(i&&c)return{videoUrl:i,audioUrl:c};y("Uploading files to Supabase...");let s=async e=>{let s=new FormData;s.append("file",e),s.append("filename",e.name);let l=await fetch("/api/upload",{method:"POST",body:s});if(!l.ok)throw Error(await l.text());return l.json()},[a,t]=await Promise.all([s(e),s(l)]);return r(a.url),d(t.url),y("Uploaded to Supabase."),{videoUrl:a.url,audioUrl:t.url}}async function g(){try{let e=await N();if(!e)return;p("QUEUED"),m([]),y("Pushing lipsync job...");let s=await fetch("/api/lipsync-beta/push",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({videoUrl:e.videoUrl,audioUrl:e.audioUrl})});if(!s.ok){y("Push failed: "+await s.text()),p("FAILED");return}let l=await s.json();u(l.id),y("Job created: ".concat(l.id,", status=").concat(l.status)),j.current&&clearInterval(j.current),j.current=setInterval(async()=>{let e=await fetch("".concat("/api/lipsync-beta/status","?id=").concat(l.id).concat(f?"&enhancer=true":""));if(!e.ok)return;let s=await e.json();s.status&&s.status!==h&&y("Status: ".concat(s.status)),p(s.status),("COMPLETED"===s.status||"FAILED"===s.status||"succeeded"===s.status)&&(clearInterval(j.current),j.current=null,("COMPLETED"===s.status||"succeeded"===s.status)&&s.outputUrl&&(window.__SYNC_OUTPUT_URL__=s.outputUrl,s.upscaledUrl&&(window.__SYNC_UPSCALED_URL__=s.upscaledUrl)),s.error&&y("Error: ".concat("string"==typeof s.error?s.error:JSON.stringify(s.error))),s.upscaledUrl&&y("Enhancer upscaling complete."))},2500)}catch(e){y("Error: "+e.message),p("FAILED")}}(0,t.useCallback)(async e=>{s(e)},[]),(0,t.useCallback)(async e=>{n(e)},[]),(0,t.useEffect)(()=>()=>{j.current&&clearInterval(j.current)},[]);let D=window.__SYNC_OUTPUT_URL__||null,E=window.__SYNC_UPSCALED_URL__||null;return(0,a.jsxs)("div",{className:"container",children:[(0,a.jsxs)("div",{className:"panel output",children:[(0,a.jsxs)("div",{className:"header",children:[(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,a.jsx)("h2",{style:{margin:0},children:"Output (BETA)"}),(0,a.jsx)("span",{className:"badge",children:h})]}),(0,a.jsxs)("div",{className:"small",children:["Job ID: ",null!=o?o:"—"]})]}),(0,a.jsx)("div",{className:"outputArea",style:{display:"grid",gap:12},children:("COMPLETED"===h||"succeeded"===h)&&(D||E)?(0,a.jsxs)("div",{style:{display:"grid",gap:12},children:[D&&(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"small",children:"Base output"}),(0,a.jsx)("video",{src:D,controls:!0,style:{maxWidth:"100%",maxHeight:"100%",borderRadius:12}})]}),E&&(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"small",children:"Upscaled (ENHANCER)"}),(0,a.jsx)("video",{src:E,controls:!0,style:{maxWidth:"100%",maxHeight:"100%",borderRadius:12}})]})]}):(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{style:{fontSize:16,color:"#b7c2df"},children:"The result will appear here."}),(0,a.jsxs)("div",{className:"kv",style:{marginTop:12},children:[(0,a.jsx)("div",{children:"Video URL"}),(0,a.jsx)("div",{className:"small",children:null!=i?i:"—"}),(0,a.jsx)("div",{children:"Audio URL"}),(0,a.jsx)("div",{className:"small",children:null!=c?c:"—"})]})]})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{style:{margin:"8px 0 6px"},children:"Log"}),(0,a.jsx)("pre",{className:"log",children:v.join("\n")})]})]}),(0,a.jsxs)("div",{className:"panel",children:[(0,a.jsxs)("div",{className:"header",children:[(0,a.jsx)("h3",{style:{margin:0},children:"Inputs (BETA)"}),(0,a.jsx)("span",{className:"badge",children:"Sync.so"})]}),(0,a.jsxs)("label",{className:"small",style:{display:"flex",gap:8,alignItems:"center",marginBottom:8},children:[(0,a.jsx)("input",{type:"checkbox",checked:f,onChange:e=>x(e.target.checked)})," ENHANCER (show both)"]}),(0,a.jsxs)("div",{className:"dnd ".concat(""),onDragOver:e=>{e.preventDefault()},onDrop:e=>{var l;e.preventDefault();let a=null===(l=e.dataTransfer.files)||void 0===l?void 0:l[0];a&&s(a)},onClick:()=>{let e=document.createElement("input");e.type="file",e.accept="video/*",e.onchange=()=>{var l;let a=(null===(l=e.files)||void 0===l?void 0:l[0])||null;a&&s(a)},e.click()},children:[(0,a.jsx)("div",{style:{fontWeight:700},children:"Video"}),(0,a.jsx)("div",{className:"small",children:"MP4/MOV recommended"}),e&&(0,a.jsxs)("div",{className:"fileInfo",children:["\uD83D\uDCF9 ",e.name," (",Math.round(e.size/1024/1024*10)/10," MB)"]}),i&&(0,a.jsxs)("div",{className:"fileInfo",children:["\uD83D\uDD17 Uploaded: ",i]})]}),(0,a.jsxs)("div",{className:"dnd",style:{marginTop:12},onDragOver:e=>{e.preventDefault()},onDrop:e=>{var s;e.preventDefault();let l=null===(s=e.dataTransfer.files)||void 0===s?void 0:s[0];l&&n(l)},onClick:()=>{let e=document.createElement("input");e.type="file",e.accept="audio/*",e.onchange=()=>{var s;let l=(null===(s=e.files)||void 0===s?void 0:s[0])||null;l&&n(l)},e.click()},children:[(0,a.jsx)("div",{style:{fontWeight:700},children:"Voiceover"}),(0,a.jsx)("div",{className:"small",children:"WAV/MP3 preferred"}),l&&(0,a.jsxs)("div",{className:"fileInfo",children:["\uD83C\uDF99️ ",l.name," (",Math.round(l.size/1024/1024*10)/10," MB)"]}),c&&(0,a.jsxs)("div",{className:"fileInfo",children:["\uD83D\uDD17 Uploaded: ",c]})]}),(0,a.jsx)("button",{className:"btn",onClick:g,disabled:!e||!l,children:"Generate (BETA)"})]})]})}},8877:function(){}},function(e){e.O(0,[404,971,23,744],function(){return e(e.s=403)}),_N_E=e.O()}]);