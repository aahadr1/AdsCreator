(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[136],{4667:function(e,a,s){Promise.resolve().then(s.bind(s,5951))},5951:function(e,a,s){"use strict";s.r(a),s.d(a,{default:function(){return n}});var i=s(7437);s(8877);var t=s(2265),l=s(1180);function n(){let[e,a]=(0,t.useState)(null),[s,n]=(0,t.useState)(null),[r,o]=(0,t.useState)("en"),[d,c]=(0,t.useState)(""),[u,p]=(0,t.useState)(0),[h,m]=(0,t.useState)(!1),[f,v]=(0,t.useState)(null),[x,j]=(0,t.useState)(null),[g,y]=(0,t.useState)(null),w=(0,t.useCallback)(e=>{a(e)},[]),b=(0,t.useCallback)(async e=>{let a=new FormData;a.append("file",e),a.append("filename",e.name);let s=await fetch("/api/upload",{method:"POST",body:a});if(!s.ok)throw Error(await s.text());return(await s.json()).url},[]);async function N(){m(!0),v(null),j(null);try{let{data:{user:a}}=await l._.auth.getUser();if(!a)throw Error("Please sign in at /auth before creating a task.");if(!e)throw Error("Please select an audio file.");let i=s;i||(i=await b(e),n(i));let t={language:r||void 0,prompt:d||void 0,temperature:u,audio_file:i},{data:o,error:c}=await l._.from("tasks").insert({user_id:a.id,type:"lipsync",status:"queued",provider:"replicate",model_id:"openai/gpt-4o-transcribe",options_json:t,audio_url:i,text_input:d||null}).select("*").single();if(c||!o)throw Error((null==c?void 0:c.message)||"Failed to create task");y(o.id);let p=await fetch("/api/transcription/run",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({language:r||void 0,prompt:d||void 0,temperature:u,audio_file:i})});if(!p.ok)throw Error(await p.text());let h=(await p.json()).text||"";j(h),(null==o?void 0:o.id)&&await l._.from("tasks").update({status:"finished"}).eq("id",o.id)}catch(e){v((null==e?void 0:e.message)||"Failed to transcribe"),g&&await l._.from("tasks").update({status:"error"}).eq("id",g)}finally{m(!1)}}return(0,i.jsxs)("div",{className:"container",children:[(0,i.jsxs)("div",{className:"panel output",children:[(0,i.jsx)("div",{className:"header",children:(0,i.jsx)("h2",{style:{margin:0},children:"Transcript"})}),(0,i.jsx)("div",{className:"outputArea",style:{whiteSpace:"pre-wrap"},children:x?(0,i.jsx)("div",{children:x}):(0,i.jsx)("div",{style:{fontSize:16,color:"#b7c2df"},children:"The humanized transcript will appear here."})}),f&&(0,i.jsx)("div",{className:"small",style:{color:"#ff7878"},children:f})]}),(0,i.jsxs)("div",{className:"panel",children:[(0,i.jsx)("div",{className:"header",children:(0,i.jsx)("h3",{style:{margin:0},children:"Inputs"})}),(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{className:"small",children:"Audio file"}),(0,i.jsxs)("label",{className:"dnd",style:{display:"block"},children:[(0,i.jsx)("input",{type:"file",accept:"audio/*,video/mp4,video/webm",style:{display:"none"},onChange:e=>{var a;let s=null===(a=e.target.files)||void 0===a?void 0:a[0];s&&w(s)}}),e?(0,i.jsxs)("div",{className:"fileInfo",children:[(0,i.jsx)("span",{children:e.name}),(0,i.jsxs)("span",{children:["(",(e.size/1048576).toFixed(2)," MB)"]})]}):(0,i.jsx)("div",{className:"small",style:{color:"#b7c2df"},children:"Click to select an audio file"})]})]}),(0,i.jsxs)("div",{className:"options",style:{marginTop:12},children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{className:"small",children:"Language (ISO-639-1, e.g. en)"}),(0,i.jsx)("input",{className:"input",placeholder:"en",value:r,onChange:e=>o(e.target.value)})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{className:"small",children:"Temperature (0-1)"}),(0,i.jsx)("input",{className:"input",type:"number",step:.1,min:0,max:1,value:u,onChange:e=>p(parseFloat(e.target.value))})]})]}),(0,i.jsxs)("div",{style:{marginTop:12},children:[(0,i.jsx)("div",{className:"small",children:"Prompt (optional)"}),(0,i.jsx)("textarea",{className:"input",rows:4,placeholder:"Optional style guide or context",value:d,onChange:e=>c(e.target.value)})]}),(0,i.jsx)("button",{className:"btn",style:{marginTop:12},disabled:!e||h,onClick:N,children:h?"Transcribingâ€¦":"Transcribe & Humanize"})]})]})}},1180:function(e,a,s){"use strict";s.d(a,{_:function(){return i}});let i=(0,s(6887).eI)("https://ueunqeqrvtuofpdoozye.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InVldW5xZXFydnR1b2ZwZG9venllIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTYxOTM4NjMsImV4cCI6MjA3MTc2OTg2M30.JY5i-uB5vZJ6enhWVgf9Bwg9bK2BFjmuXuOfjbQEQUw",{auth:{persistSession:!0,autoRefreshToken:!0}})},8877:function(){}},function(e){e.O(0,[404,887,971,23,744],function(){return e(e.s=4667)}),_N_E=e.O()}]);