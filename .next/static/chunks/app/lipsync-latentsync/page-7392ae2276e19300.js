(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[209],{6810:function(e,a,l){Promise.resolve().then(l.bind(l,8940))},8940:function(e,a,l){"use strict";l.r(a),l.d(a,{default:function(){return t}});var s=l(7437);l(8877);var n=l(2265);function t(){let[e,a]=(0,n.useState)(null),[l,t]=(0,n.useState)(null),[i,r]=(0,n.useState)(null),[c,d]=(0,n.useState)(null),[u,o]=(0,n.useState)(null),[h,v]=(0,n.useState)("unknown"),[m,p]=(0,n.useState)([]),[f,x]=(0,n.useState)(30),[j,N]=(0,n.useState)(1.5),y=(0,n.useRef)(null),g=e=>p(a=>[...a,"".concat(new Date().toLocaleTimeString(),"  ").concat(e)]),D=(0,n.useCallback)(e=>a(e),[]),S=(0,n.useCallback)(e=>t(e),[]);async function b(){if(!e||!l)return!1;if(i&&c)return{videoUrl:i,audioUrl:c};g("Uploading files to Supabase...");let a=async e=>{let a=new FormData;a.append("file",e),a.append("filename",e.name);let l=await fetch("/api/upload",{method:"POST",body:a});if(!l.ok)throw Error(await l.text());return l.json()},[s,n]=await Promise.all([a(e),a(l)]);return r(s.url),d(n.url),g("Uploaded."),{videoUrl:s.url,audioUrl:n.url}}async function w(){try{let e=await b();if(!e)return;v("queued"),p([]),g("Pushing LatentSync job...");let a=await fetch("/api/latentsync/push",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({videoUrl:e.videoUrl,audioUrl:e.audioUrl,options:{inference_steps:f,guidance_scale:j}})});if(!a.ok){g("Push failed: "+await a.text()),v("error");return}let l=await a.json();o(l.id),g("Job created: ".concat(l.id)),y.current&&clearInterval(y.current),y.current=setInterval(async()=>{let e=await fetch("/api/latentsync/status?id=".concat(l.id));if(!e.ok)return;let a=await e.json();a.status&&a.status!==h&&g("Status: ".concat(a.status)),v(a.status),("succeeded"===a.status||"failed"===a.status)&&(clearInterval(y.current),y.current=null,a.outputUrl&&(window.__LATENTSYNC_OUTPUT__=a.outputUrl),a.error&&g("Error: ".concat(JSON.stringify(a.error))))},2500)}catch(e){g("Error: "+e.message),v("error")}}(0,n.useEffect)(()=>()=>{y.current&&clearInterval(y.current)},[]);let T=window.__LATENTSYNC_OUTPUT__||null;return(0,s.jsxs)("div",{className:"container",children:[(0,s.jsxs)("div",{className:"panel output",children:[(0,s.jsxs)("div",{className:"header",children:[(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,s.jsx)("h2",{style:{margin:0},children:"Output (LatentSync)"}),(0,s.jsx)("span",{className:"badge",children:h})]}),(0,s.jsxs)("div",{className:"small",children:["Job ID: ",null!=u?u:"—"]})]}),(0,s.jsx)("div",{className:"outputArea",children:"succeeded"===h&&T?(0,s.jsx)("video",{src:T,controls:!0,style:{maxWidth:"100%",maxHeight:"100%",borderRadius:12}}):(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{style:{fontSize:16,color:"#b7c2df"},children:"The result will appear here."}),(0,s.jsxs)("div",{className:"kv",style:{marginTop:12},children:[(0,s.jsx)("div",{children:"Video URL"}),(0,s.jsx)("div",{className:"small",children:null!=i?i:"—"}),(0,s.jsx)("div",{children:"Audio URL"}),(0,s.jsx)("div",{className:"small",children:null!=c?c:"—"})]})]})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{style:{margin:"8px 0 6px"},children:"Log"}),(0,s.jsx)("pre",{className:"log",children:m.join("\n")})]})]}),(0,s.jsxs)("div",{className:"panel",children:[(0,s.jsxs)("div",{className:"header",children:[(0,s.jsx)("h3",{style:{margin:0},children:"Inputs (LatentSync)"}),(0,s.jsx)("span",{className:"badge",children:"ByteDance"})]}),(0,s.jsxs)("div",{className:"dnd",onDragOver:e=>{e.preventDefault()},onDrop:e=>{var a;e.preventDefault();let l=null===(a=e.dataTransfer.files)||void 0===a?void 0:a[0];l&&D(l)},onClick:()=>{let e=document.createElement("input");e.type="file",e.accept="video/*",e.onchange=()=>{var a;let l=(null===(a=e.files)||void 0===a?void 0:a[0])||null;l&&D(l)},e.click()},children:[(0,s.jsx)("div",{style:{fontWeight:700},children:"Video"}),(0,s.jsx)("div",{className:"small",children:"MP4/MOV recommended"}),e&&(0,s.jsxs)("div",{className:"fileInfo",children:["\uD83D\uDCF9 ",e.name," (",Math.round(e.size/1024/1024*10)/10," MB)"]}),i&&(0,s.jsxs)("div",{className:"fileInfo",children:["\uD83D\uDD17 Uploaded: ",i]})]}),(0,s.jsxs)("div",{className:"dnd",style:{marginTop:12},onDragOver:e=>{e.preventDefault()},onDrop:e=>{var a;e.preventDefault();let l=null===(a=e.dataTransfer.files)||void 0===a?void 0:a[0];l&&S(l)},onClick:()=>{let e=document.createElement("input");e.type="file",e.accept="audio/*",e.onchange=()=>{var a;let l=(null===(a=e.files)||void 0===a?void 0:a[0])||null;l&&S(l)},e.click()},children:[(0,s.jsx)("div",{style:{fontWeight:700},children:"Voiceover"}),(0,s.jsx)("div",{className:"small",children:"WAV/MP3 preferred"}),l&&(0,s.jsxs)("div",{className:"fileInfo",children:["\uD83C\uDF99️ ",l.name," (",Math.round(l.size/1024/1024*10)/10," MB)"]}),c&&(0,s.jsxs)("div",{className:"fileInfo",children:["\uD83D\uDD17 Uploaded: ",c]})]}),(0,s.jsx)("div",{style:{marginTop:16,fontWeight:700},children:"Options"}),(0,s.jsxs)("div",{className:"options",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"small",children:"Inference steps"}),(0,s.jsx)("input",{className:"select",type:"number",min:20,max:50,value:f,onChange:e=>x(parseInt(e.target.value||"30",10))})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"small",children:"Guidance scale"}),(0,s.jsx)("input",{className:"select",type:"number",step:.1,min:1,max:3,value:j,onChange:e=>N(parseFloat(e.target.value||"1.5"))})]})]}),(0,s.jsx)("button",{className:"btn",onClick:w,disabled:!e||!l,children:"Generate (LatentSync)"})]})]})}},8877:function(){}},function(e){e.O(0,[404,971,23,744],function(){return e(e.s=6810)}),_N_E=e.O()}]);