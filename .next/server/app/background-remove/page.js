(()=>{var e={};e.id=7785,e.ids=[7785],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},85477:e=>{"use strict";e.exports=require("punycode")},12781:e=>{"use strict";e.exports=require("stream")},57310:e=>{"use strict";e.exports=require("url")},59796:e=>{"use strict";e.exports=require("zlib")},19248:(e,a,t)=>{"use strict";t.r(a),t.d(a,{GlobalError:()=>n.a,__next_app__:()=>p,originalPathname:()=>u,pages:()=>c,routeModule:()=>g,tree:()=>o}),t(37065),t(98131),t(35866);var s=t(23191),r=t(88716),i=t(37922),n=t.n(i),l=t(95231),d={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>l[e]);t.d(a,d);let o=["",{children:["background-remove",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,37065)),"/Users/Aaron/Downloads/next-lipsync-app/app/background-remove/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,98131)),"/Users/Aaron/Downloads/next-lipsync-app/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,35866,23)),"next/dist/client/components/not-found-error"]}],c=["/Users/Aaron/Downloads/next-lipsync-app/app/background-remove/page.tsx"],u="/background-remove/page",p={require:t,loadChunk:()=>Promise.resolve()},g=new s.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/background-remove/page",pathname:"/background-remove",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},84777:(e,a,t)=>{Promise.resolve().then(t.bind(t,77577))},97017:(e,a,t)=>{Promise.resolve().then(t.bind(t,20945))},9922:(e,a,t)=>{Promise.resolve().then(t.t.bind(t,12994,23)),Promise.resolve().then(t.t.bind(t,96114,23)),Promise.resolve().then(t.t.bind(t,9727,23)),Promise.resolve().then(t.t.bind(t,79671,23)),Promise.resolve().then(t.t.bind(t,41868,23)),Promise.resolve().then(t.t.bind(t,84759,23))},77577:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>l});var s=t(10326);t(4047);var r=t(17577),i=t(25472),n=t(43120);function l(){let[e,a]=(0,r.useState)(null),[t,l]=(0,r.useState)(null),[d,o]=(0,r.useState)(null),[c,u]=(0,r.useState)("unknown"),[p,g]=(0,r.useState)([]),[m,h]=(0,r.useState)(null),[x,f]=(0,r.useState)(null),[v,b]=(0,r.useState)("Normal"),[y,j]=(0,r.useState)("#FFFFFF"),w=(0,r.useRef)(null),N=(0,r.useRef)(null),k=e=>g(a=>[...a,`${new Date().toLocaleTimeString()}  ${e}`]),S=(0,r.useCallback)(e=>a(e),[]),P=(0,r.useCallback)(async e=>{let a=new FormData;a.append("file",e),a.append("filename",e.name);let t=await fetch("/api/upload",{method:"POST",body:a});if(!t.ok)throw Error(await t.text());return(await t.json()).url},[]);async function _(e){try{let a=await fetch("/api/persist",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:e,filename:e.split("/").pop()||null,folder:"bgremove"})});if(!a.ok)return e;let t=await a.json();return"string"==typeof t?.url?t.url:e}catch{return e}}async function I(){u("queued"),g([]),o(null),h(null);try{let{data:{user:a}}=await i._.auth.getUser();if(!a){k("Please sign in at /auth before creating a task."),u("failed");return}if(!e){k("Please select a video file."),u("failed");return}let s=t;s||(k("Uploading video…"),s=await P(e),l(s),k("Uploaded."));let r={video:s,mode:v,background_color:y},{data:n,error:d}=await i._.from("tasks").insert({user_id:a.id,type:"bgremove",status:"queued",provider:"replicate",backend:"lucataco/rembg-video",options_json:r,video_url:s}).select("*").single();if(d||!n){k("Failed to create task: "+(d?.message||"unknown")),u("failed");return}f(n.id),k("Submitting to Replicate: lucataco/rembg-video");let c=await fetch("/api/replicate/run",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:"lucataco/rembg-video",input:r})});if(!c.ok){k("Submission failed: "+await c.text()),u("failed");return}let p=await c.json();h(p.id);let g=p.status||"queued";u(g),k(`Prediction created: ${p.id}`),n?.id&&await i._.from("tasks").update({job_id:p.id,status:g}).eq("id",n.id),w.current&&clearInterval(w.current),w.current=setInterval(async()=>{if(!p.id)return;let e=await fetch(`/api/replicate/status?id=${p.id}`);if(!e.ok)return;let a=await e.json(),t=a.status||"unknown";if(N.current!==t&&(k(`Status: ${t}`),N.current=t),u(t),a.outputUrl&&"string"==typeof a.outputUrl){let e=await _(a.outputUrl),t=`/api/proxy?url=${encodeURIComponent(e)}`;o(t)}if(n?.id){let e=a.outputUrl?`/api/proxy?url=${encodeURIComponent(a.outputUrl)}`:null;await i._.from("tasks").update({status:t,output_url:e}).eq("id",n.id)}("succeeded"===t||"failed"===t||"canceled"===t)&&(clearInterval(w.current),w.current=null,a.error&&k(`Error: ${"string"==typeof a.error?a.error:JSON.stringify(a.error)}`))},2e3)}catch(e){k("Error: "+e?.message),u("failed"),x&&await i._.from("tasks").update({status:"error"}).eq("id",x)}}return(0,s.jsxs)("div",{className:"container",children:[(0,s.jsxs)("div",{className:"panel output",children:[(0,s.jsxs)("div",{className:"header",children:[(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[s.jsx("h2",{style:{margin:0},children:"Output"}),s.jsx("span",{className:"badge",children:c.toUpperCase?.()||c})]}),(0,s.jsxs)("div",{className:"small",children:["Prediction ID: ",m??"—"]})]}),s.jsx("div",{className:"outputArea",children:d?(0,s.jsxs)("div",{children:[s.jsx("video",{src:d,controls:!0,style:{width:"100%",borderRadius:8},onError:()=>k("Video failed to play. Open in new tab using the link below.")}),s.jsx("div",{className:"small",style:{marginTop:8},children:s.jsx("a",{href:d,target:"_blank",rel:"noreferrer",children:"Open output in new tab"})}),s.jsx(n.Z,{mediaUrl:d,kind:"video",size:"large",context:{model:"lucataco/rembg-video",inputs:t?[{type:"video",url:t,label:"input"}]:void 0,extra:{mode:v,backgroundColor:y}}})]}):s.jsx("div",{style:{fontSize:16,color:"#b7c2df"},children:"Processed video will appear here."})}),(0,s.jsxs)("div",{children:[s.jsx("div",{className:"small",style:{margin:"8px 0 6px"},children:"Log"}),s.jsx("pre",{className:"log",children:p.join("\n")})]})]}),(0,s.jsxs)("div",{className:"panel",children:[s.jsx("div",{className:"header",children:s.jsx("h3",{style:{margin:0},children:"Inputs (Replicate)"})}),(0,s.jsxs)("div",{children:[s.jsx("div",{className:"small",children:"Video file"}),(0,s.jsxs)("label",{className:"dnd",style:{display:"block"},children:[s.jsx("input",{type:"file",accept:"video/*",style:{display:"none"},onChange:e=>{let a=e.target.files?.[0];a&&S(a)}}),e?(0,s.jsxs)("div",{className:"fileInfo",children:[s.jsx("span",{children:e.name}),(0,s.jsxs)("span",{children:["(",(e.size/1048576).toFixed(2)," MB)"]})]}):s.jsx("div",{className:"small",style:{color:"#b7c2df"},children:"Click to select a video"})]})]}),(0,s.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, minmax(0, 1fr))",gap:12,marginTop:12},children:[(0,s.jsxs)("div",{children:[s.jsx("div",{className:"small",children:"mode"}),(0,s.jsxs)("select",{className:"select",value:v,onChange:e=>b(e.target.value),children:[s.jsx("option",{value:"Fast",children:"Fast"}),s.jsx("option",{value:"Normal",children:"Normal"})]})]}),(0,s.jsxs)("div",{children:[s.jsx("div",{className:"small",children:"background_color"}),s.jsx("input",{className:"select",type:"text",value:y,onChange:e=>j(e.target.value),placeholder:"#FFFFFF"})]})]}),s.jsx("button",{className:"btn",style:{marginTop:12},disabled:!e||"processing"===c||"queued"===c,onClick:I,children:"processing"===c||"queued"===c?"Processing…":"Remove Background"})]})]})}},43120:(e,a,t)=>{"use strict";t.d(a,{Z:()=>n});var s=t(10326),r=t(17577),i=t(25472);let n=function({mediaUrl:e,kind:a,context:t,size:n="default"}){let[l,d]=(0,r.useState)(!1),[o,c]=(0,r.useState)(!1),[u,p]=(0,r.useState)(null),[g,m]=(0,r.useState)("idle");async function h(){if(e){d(!0),p(null),c(!1);try{let{data:{user:s}}=await i._.auth.getUser();if(!s)throw Error("Please sign in at /auth to save assets.");let r=await i._.auth.getSession(),n=r.data.session?.access_token||"";m("pending");let l=await fetch("/api/assets/add",{method:"POST",headers:{"Content-Type":"application/json",Authorization:n?`Bearer ${n}`:""},body:JSON.stringify({url:e,kind:a,context:t})});if(!l.ok)throw Error(await l.text());c(!0),m("indexing");try{let e=await l.json(),a=e?.asset?.id;if(a){let e=setInterval(async()=>{try{let{data:t}=await i._.from("media_assets").select("status").eq("id",a).single(),s=t?.status||"pending";"ready"===s&&(m("ready"),clearInterval(e)),"error"===s&&(m("error"),clearInterval(e))}catch{}},2e3);setTimeout(()=>clearInterval(e),2e4)}else m("ready")}catch{m("ready")}}catch(e){p(e instanceof Error?e.message:"Failed to add to database")}finally{d(!1)}}}return(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8,marginTop:8},children:[s.jsx("button",{className:"btn",type:"button","aria-label":"Add this media to database",onClick:h,onKeyDown:e=>(function({event:e,onActivate:a}){("Enter"===e.key||" "===e.key)&&a()})({event:e,onActivate:h}),disabled:l,style:{padding:"large"===n?"12px 14px":"6px 10px",width:"large"===n?"100%":void 0,fontSize:"large"===n?16:void 0},children:l?"Saving to database…":o?"Saved ✓":"Save to database"}),"idle"!==g&&s.jsx("span",{className:"badge","aria-live":"polite",children:"pending"===g?"Pending":"indexing"===g?"Indexing":"ready"===g?"Ready":"error"===g?"Error":""}),u&&s.jsx("div",{className:"small",style:{color:"#ff7878"},children:u})]})}},20945:(e,a,t)=>{"use strict";t.d(a,{LayoutWrapper:()=>k});var s=t(10326);t(17577);var r=t(35047),i=t(29798),n=t(58775),l=t(36283),d=t(49758),o=t(71709),c=t(1572),u=t(56562),p=t(61584),g=t(87444),m=t(31540),h=t(88307),x=t(2634),f=t(71208),v=t(88319),b=t(66697),y=t(32691),j=t(88378);let w=[{href:"/",label:"Home",icon:s.jsx(i.Z,{size:18})},{href:"/lipsync-new",label:"+ New Lipsync",icon:s.jsx(n.Z,{size:18}),gradient:"linear-gradient(90deg, #6aa4ff, #ff9f43)"},{href:"/transcription/bulk",label:"+ Bulk Transcription",icon:s.jsx(l.Z,{size:18}),gradient:"linear-gradient(90deg, #ff9f43, #6aa4ff)"},{href:"/veo",label:"+ New Video",icon:s.jsx(d.Z,{size:18}),gradient:"linear-gradient(90deg, #a36bff, #6aa4ff)"},{href:"/image",label:"+ New Image",icon:s.jsx(o.Z,{size:18}),gradient:"linear-gradient(90deg, #42d392, #a36bff)"},{href:"/enhance",label:"+ New Enhance",icon:s.jsx(c.Z,{size:18}),gradient:"linear-gradient(90deg, #ffbd2e, #42d392)"},{href:"/tts",label:"+ New Text to Speech",icon:s.jsx(u.Z,{size:18}),gradient:"linear-gradient(90deg, #ffbd2e, #ff6b6b)"},{href:"/adscript",label:"+ New Ad Script",icon:s.jsx(p.Z,{size:18}),gradient:"linear-gradient(90deg, #6aa4ff, #ff9f43)"},{href:"/background-remove",label:"+ Remove Background",icon:s.jsx(g.Z,{size:18}),gradient:"linear-gradient(90deg, #42d392, #ff6b6b)"},{href:"/download",label:"+ TikTok Downloader",icon:s.jsx(m.Z,{size:18}),gradient:"linear-gradient(90deg, #1db954, #2b8a3e)"},{href:"/spy",label:"Spy Tool",icon:s.jsx(h.Z,{size:18}),gradient:"linear-gradient(90deg, #6aa4ff, #42d392)"},{href:"/editor",label:"Editor",icon:s.jsx(x.Z,{size:18}),gradient:"linear-gradient(90deg, #42d392, #a36bff)"},{href:"/auto-edit-beta",label:"+ Auto Edit Beta",icon:s.jsx(f.Z,{size:18}),gradient:"linear-gradient(90deg, #6aa4ff, #a36bff)"},{href:"/library",label:"Database",icon:s.jsx(v.Z,{size:18}),gradient:"linear-gradient(90deg, #1db954, #6aa4ff)"},{href:"/tasks",label:"Tasks",icon:s.jsx(b.Z,{size:18})},{href:"/auth",label:"Sign in / Up",icon:s.jsx(y.Z,{size:18})},{href:"#",label:"Settings (soon)",icon:s.jsx(j.Z,{size:18}),disabled:!0}];function N(){let e=(0,r.usePathname)();return(0,s.jsxs)("aside",{className:"sidebar",children:[s.jsx("div",{className:"sidebar-header",children:s.jsx("h1",{className:"sidebar-title",children:"Lipsync"})}),s.jsx("nav",{className:"sidebar-nav",children:w.map(a=>{let t=e===a.href,r=!!a.gradient;return(0,s.jsxs)("a",{href:a.href,className:`nav-item ${t?"nav-item-active":""} ${r?"nav-item-gradient":""} ${a.disabled?"nav-item-disabled":""}`,style:r?{background:a.gradient}:void 0,onClick:a.disabled?e=>e.preventDefault():void 0,title:a.label,children:[s.jsx("span",{className:"nav-item-icon",children:a.icon}),s.jsx("span",{className:"nav-item-label",children:a.label})]},a.href)})}),s.jsx("div",{className:"sidebar-footer",children:(0,s.jsxs)("div",{className:"sidebar-copyright",children:["\xa9 ",new Date().getFullYear()," Lipsync"]})})]})}function k({children:e}){return"/"===(0,r.usePathname)()?s.jsx(s.Fragment,{children:e}):(0,s.jsxs)("div",{className:"app-layout",children:[s.jsx(N,{}),(0,s.jsxs)("main",{className:"app-main",children:[s.jsx("div",{className:"app-header",children:(0,s.jsxs)("div",{className:"app-header-content",children:[s.jsx("div",{className:"app-tagline",children:"Build great lipsyncs."}),(0,s.jsxs)("div",{className:"app-user",children:[s.jsx("div",{className:"user-email",id:"user-email"}),s.jsx("div",{className:"user-avatar-small"})]})]})}),s.jsx("div",{className:"app-content",children:e})]})]})}},25472:(e,a,t)=>{"use strict";t.d(a,{_:()=>s});let s=(0,t(47939).eI)("https://ueunqeqrvtuofpdoozye.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InVldW5xZXFydnR1b2ZwZG9venllIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTYxOTM4NjMsImV4cCI6MjA3MTc2OTg2M30.JY5i-uB5vZJ6enhWVgf9Bwg9bK2BFjmuXuOfjbQEQUw",{auth:{persistSession:!0,autoRefreshToken:!0}})},37065:(e,a,t)=>{"use strict";t.r(a),t.d(a,{$$typeof:()=>n,__esModule:()=>i,default:()=>l});var s=t(68570);let r=(0,s.createProxy)(String.raw`/Users/Aaron/Downloads/next-lipsync-app/app/background-remove/page.tsx`),{__esModule:i,$$typeof:n}=r;r.default;let l=(0,s.createProxy)(String.raw`/Users/Aaron/Downloads/next-lipsync-app/app/background-remove/page.tsx#default`)},98131:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>c,metadata:()=>o});var s=t(19510);t(67272);var r=t(68570);let i=(0,r.createProxy)(String.raw`/Users/Aaron/Downloads/next-lipsync-app/components/LayoutWrapper.tsx`),{__esModule:n,$$typeof:l}=i;i.default;let d=(0,r.createProxy)(String.raw`/Users/Aaron/Downloads/next-lipsync-app/components/LayoutWrapper.tsx#LayoutWrapper`),o={title:"Lipsync App",description:"Upload a video + audio and get back a lipsynced video using Sieve",viewport:"width=device-width, initial-scale=1"};function c({children:e}){return s.jsx("html",{lang:"en",children:s.jsx("body",{suppressHydrationWarning:!0,children:s.jsx(d,{children:e})})})}},67272:()=>{},4047:()=>{}};var a=require("../../webpack-runtime.js");a.C(e);var t=e=>a(a.s=e),s=a.X(0,[8948,7893,7939],()=>t(19248));module.exports=s})();