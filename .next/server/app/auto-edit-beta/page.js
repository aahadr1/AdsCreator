(()=>{var e={};e.id=3873,e.ids=[3873],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},85477:e=>{"use strict";e.exports=require("punycode")},12781:e=>{"use strict";e.exports=require("stream")},57310:e=>{"use strict";e.exports=require("url")},59796:e=>{"use strict";e.exports=require("zlib")},54592:(e,a,t)=>{"use strict";t.r(a),t.d(a,{GlobalError:()=>n.a,__next_app__:()=>u,originalPathname:()=>p,pages:()=>c,routeModule:()=>h,tree:()=>o}),t(49418),t(98131),t(35866);var s=t(23191),i=t(88716),r=t(37922),n=t.n(r),l=t(95231),d={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>l[e]);t.d(a,d);let o=["",{children:["auto-edit-beta",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,49418)),"/Users/Aaron/Downloads/next-lipsync-app/app/auto-edit-beta/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,98131)),"/Users/Aaron/Downloads/next-lipsync-app/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,35866,23)),"next/dist/client/components/not-found-error"]}],c=["/Users/Aaron/Downloads/next-lipsync-app/app/auto-edit-beta/page.tsx"],p="/auto-edit-beta/page",u={require:t,loadChunk:()=>Promise.resolve()},h=new s.AppPageRouteModule({definition:{kind:i.x.APP_PAGE,page:"/auto-edit-beta/page",pathname:"/auto-edit-beta",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},54202:(e,a,t)=>{Promise.resolve().then(t.bind(t,49240))},97017:(e,a,t)=>{Promise.resolve().then(t.bind(t,20945))},9922:(e,a,t)=>{Promise.resolve().then(t.t.bind(t,12994,23)),Promise.resolve().then(t.t.bind(t,96114,23)),Promise.resolve().then(t.t.bind(t,9727,23)),Promise.resolve().then(t.t.bind(t,79671,23)),Promise.resolve().then(t.t.bind(t,41868,23)),Promise.resolve().then(t.t.bind(t,84759,23))},49240:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>n});var s=t(10326);t(4047);var i=t(17577),r=t(25472);function n(){let[e,a]=(0,i.useState)(""),[t,n]=(0,i.useState)(null),[l,d]=(0,i.useState)(null),[o,c]=(0,i.useState)(!1),[p,u]=(0,i.useState)([]),[h,m]=(0,i.useState)({}),[g,x]=(0,i.useState)([]),[f,b]=(0,i.useState)([]),y=(0,i.useCallback)(e=>b(a=>[...a,`${new Date().toLocaleTimeString()}  ${e}`]),[]),j=(0,i.useCallback)(()=>{let e=document.createElement("input");e.type="file",e.accept="audio/*",e.onchange=()=>{let a=e.files?.[0]||null;a&&n(a)},e.click()},[]),v=(0,i.useCallback)(async e=>{let a=new FormData;a.append("file",e),a.append("filename",e.name);let t=await fetch("/api/upload",{method:"POST",body:a});if(!t.ok)throw Error(await t.text());return(await t.json()).url},[]),w=(0,i.useCallback)(async()=>{if(e.trim())return e.trim();if(!t&&!l)throw Error("Provide script text or an audio file.");let s=l||(t?await v(t):null);if(!s)throw Error("No audio URL.");y("Transcribing via Replicate…");let i=await fetch("/api/transcription/run",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({audio_file:s})});if(!i.ok)throw Error(await i.text());let r=((await i.json()).text||"").trim();if(!r)throw Error("Empty transcript");return a(r),r},[t,l,y,e,v]),N=(0,i.useCallback)(async()=>{c(!0),u([]),m({}),x([]),b([]);try{let{data:{user:e}}=await r._.auth.getUser();if(!e)throw Error("Please sign in at /auth to use Auto Edit.");let a=await w();y("Segmenting script…");let t=await fetch("/api/script/segment",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({script:a})});if(!t.ok)throw Error(await t.text());let s=await t.json(),i=(s.segments||[]).map((e,a)=>({...e,id:`seg_${a}`}));u(i),s.ideas_second_pass&&y(`Generated rush ideas for segments (completed: ${"number"==typeof s.ideas_completed?s.ideas_completed:"n/a"})…`);let n=i.reduce((e,a)=>e+(a.rush_ideas&&a.rush_ideas.length>0?1:0),0);y(`Rush ideas present for ${n}/${i.length} segments.`),y("Retrieving matching assets…");let l=i.map(e=>({id:e.id,text:[e.text,e.desired_rush_description,...e.rush_ideas||[]].filter(Boolean).join("\n")})),d=await fetch("/api/assets/retrieve",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({parts:l})});if(!d.ok)throw Error(await d.text());let o=await d.json();m(o.results||{}),y("Selecting best rush per segment…");let c=await fetch("/api/sequence/choose",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({segments:i,candidates:o.results})});if(!c.ok)throw Error(await c.text());let p=await c.json();x(p.items||[]),y("Done.")}catch(e){y(e instanceof Error?e.message:"Failed")}finally{c(!1)}},[w,y]),_=(0,i.useMemo)(()=>{let e=new Map;for(let a of g)e.set(a.segment_id,a);return e},[g]);return(0,s.jsxs)("div",{className:"container",style:{gridTemplateColumns:"1fr"},children:[(0,s.jsxs)("div",{className:"panel output",children:[s.jsx("div",{className:"header",children:(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[s.jsx("h2",{style:{margin:0},children:"Auto Edit (BETA)"}),s.jsx("span",{className:"badge",children:"Replicate-only"})]})}),(0,s.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[(0,s.jsxs)("div",{children:[s.jsx("div",{className:"small",children:"Script (or transcribe from audio)"}),s.jsx("textarea",{className:"select",rows:8,placeholder:"Paste your ad script or leave empty and upload audio to transcribe",value:e,onChange:e=>a(e.target.value)}),(0,s.jsxs)("div",{className:"row",style:{marginTop:8,alignItems:"center",gap:8},children:[s.jsx("button",{className:"btn",type:"button",onClick:j,onKeyDown:e=>{("Enter"===e.key||" "===e.key)&&j()},children:"Upload audio for transcription"}),t&&(0,s.jsxs)("div",{className:"small",children:["\uD83C\uDF99️ ",t.name]}),l&&(0,s.jsxs)("div",{className:"small",children:["\uD83D\uDD17 Uploaded: ",l]})]}),s.jsx("button",{className:"btn",type:"button",style:{marginTop:12},disabled:o,onClick:N,onKeyDown:e=>{("Enter"===e.key||" "===e.key)&&N()},children:o?"Running…":"Run Auto Edit"})]}),(0,s.jsxs)("div",{children:[s.jsx("div",{style:{margin:"8px 0 6px"},children:"Log"}),s.jsx("pre",{className:"log",children:f.join("\n")})]})]})]}),p.length>0&&(0,s.jsxs)("div",{className:"panel",style:{marginTop:12},children:[s.jsx("div",{className:"header",children:s.jsx("h3",{style:{margin:0},children:"Sequence"})}),s.jsx("div",{style:{display:"grid",gap:12},children:p.map(e=>{let a=_.get(e.id)||null,t=h[e.id]||[],i=a&&t.find(e=>e.id===a.chosen_asset_id)||null;return(0,s.jsxs)("div",{className:"panel",style:{padding:12},children:[(0,s.jsxs)("div",{className:"small",style:{opacity:.9},children:["Part ",e.index+1]}),s.jsx("div",{style:{fontWeight:700,marginBottom:4},children:e.text}),(0,s.jsxs)("div",{className:"small",style:{marginBottom:8,opacity:.8},children:["Rush needed: ",e.desired_rush_description||"—"]}),(0,s.jsxs)("div",{className:"small",style:{marginBottom:8},children:[s.jsx("div",{style:{opacity:.8,marginBottom:4},children:"Rush ideas:"}),e.rush_ideas&&e.rush_ideas.length>0?s.jsx("ul",{style:{margin:0,paddingLeft:18},children:e.rush_ideas.slice(0,3).map((e,a)=>s.jsx("li",{children:e},a))}):s.jsx("div",{style:{opacity:.7},children:"—"})]}),(0,s.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"260px 1fr",gap:12},children:[s.jsx("div",{children:i?"image"===i.kind||/\.(png|jpg|jpeg|gif|webp)(\?|$)/i.test(i.public_url)?s.jsx("img",{src:i.public_url,alt:i.title||"Selected image",style:{width:240,maxWidth:"100%",borderRadius:8}}):s.jsx("video",{src:i.public_url,controls:!0,style:{width:240,maxWidth:"100%",borderRadius:8}}):s.jsx("div",{className:"small",style:{opacity:.7},children:"No selection"})}),(0,s.jsxs)("div",{children:[s.jsx("div",{className:"small",style:{marginBottom:6},children:"Candidates"}),s.jsx("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:t.slice(0,6).map(e=>(0,s.jsxs)("a",{href:e.public_url,target:"_blank",rel:"noreferrer",className:"small",style:{border:"1px solid var(--border)",borderRadius:8,padding:6},children:[e.title||"asset","number"==typeof e.score?` (${Math.round(100*e.score)/100})`:""]},e.id))}),a?.reason&&(0,s.jsxs)("div",{className:"small",style:{marginTop:8,opacity:.8},children:["Reason: ",a.reason]})]})]})]},e.id)})})]})]})}},20945:(e,a,t)=>{"use strict";t.d(a,{LayoutWrapper:()=>_});var s=t(10326);t(17577);var i=t(35047),r=t(29798),n=t(58775),l=t(36283),d=t(49758),o=t(71709),c=t(1572),p=t(56562),u=t(61584),h=t(87444),m=t(31540),g=t(88307),x=t(2634),f=t(71208),b=t(88319),y=t(66697),j=t(32691),v=t(88378);let w=[{href:"/",label:"Home",icon:s.jsx(r.Z,{size:18})},{href:"/lipsync-new",label:"+ New Lipsync",icon:s.jsx(n.Z,{size:18}),gradient:"linear-gradient(90deg, #6aa4ff, #ff9f43)"},{href:"/transcription/bulk",label:"+ Bulk Transcription",icon:s.jsx(l.Z,{size:18}),gradient:"linear-gradient(90deg, #ff9f43, #6aa4ff)"},{href:"/veo",label:"+ New Video",icon:s.jsx(d.Z,{size:18}),gradient:"linear-gradient(90deg, #a36bff, #6aa4ff)"},{href:"/image",label:"+ New Image",icon:s.jsx(o.Z,{size:18}),gradient:"linear-gradient(90deg, #42d392, #a36bff)"},{href:"/enhance",label:"+ New Enhance",icon:s.jsx(c.Z,{size:18}),gradient:"linear-gradient(90deg, #ffbd2e, #42d392)"},{href:"/tts",label:"+ New Text to Speech",icon:s.jsx(p.Z,{size:18}),gradient:"linear-gradient(90deg, #ffbd2e, #ff6b6b)"},{href:"/adscript",label:"+ New Ad Script",icon:s.jsx(u.Z,{size:18}),gradient:"linear-gradient(90deg, #6aa4ff, #ff9f43)"},{href:"/background-remove",label:"+ Remove Background",icon:s.jsx(h.Z,{size:18}),gradient:"linear-gradient(90deg, #42d392, #ff6b6b)"},{href:"/download",label:"+ TikTok Downloader",icon:s.jsx(m.Z,{size:18}),gradient:"linear-gradient(90deg, #1db954, #2b8a3e)"},{href:"/spy",label:"Spy Tool",icon:s.jsx(g.Z,{size:18}),gradient:"linear-gradient(90deg, #6aa4ff, #42d392)"},{href:"/editor",label:"Editor",icon:s.jsx(x.Z,{size:18}),gradient:"linear-gradient(90deg, #42d392, #a36bff)"},{href:"/auto-edit-beta",label:"+ Auto Edit Beta",icon:s.jsx(f.Z,{size:18}),gradient:"linear-gradient(90deg, #6aa4ff, #a36bff)"},{href:"/library",label:"Database",icon:s.jsx(b.Z,{size:18}),gradient:"linear-gradient(90deg, #1db954, #6aa4ff)"},{href:"/tasks",label:"Tasks",icon:s.jsx(y.Z,{size:18})},{href:"/auth",label:"Sign in / Up",icon:s.jsx(j.Z,{size:18})},{href:"#",label:"Settings (soon)",icon:s.jsx(v.Z,{size:18}),disabled:!0}];function N(){let e=(0,i.usePathname)();return(0,s.jsxs)("aside",{className:"sidebar",children:[s.jsx("div",{className:"sidebar-header",children:s.jsx("h1",{className:"sidebar-title",children:"Lipsync"})}),s.jsx("nav",{className:"sidebar-nav",children:w.map(a=>{let t=e===a.href,i=!!a.gradient;return(0,s.jsxs)("a",{href:a.href,className:`nav-item ${t?"nav-item-active":""} ${i?"nav-item-gradient":""} ${a.disabled?"nav-item-disabled":""}`,style:i?{background:a.gradient}:void 0,onClick:a.disabled?e=>e.preventDefault():void 0,title:a.label,children:[s.jsx("span",{className:"nav-item-icon",children:a.icon}),s.jsx("span",{className:"nav-item-label",children:a.label})]},a.href)})}),s.jsx("div",{className:"sidebar-footer",children:(0,s.jsxs)("div",{className:"sidebar-copyright",children:["\xa9 ",new Date().getFullYear()," Lipsync"]})})]})}function _({children:e}){return"/"===(0,i.usePathname)()?s.jsx(s.Fragment,{children:e}):(0,s.jsxs)("div",{className:"app-layout",children:[s.jsx(N,{}),(0,s.jsxs)("main",{className:"app-main",children:[s.jsx("div",{className:"app-header",children:(0,s.jsxs)("div",{className:"app-header-content",children:[s.jsx("div",{className:"app-tagline",children:"Build great lipsyncs."}),(0,s.jsxs)("div",{className:"app-user",children:[s.jsx("div",{className:"user-email",id:"user-email"}),s.jsx("div",{className:"user-avatar-small"})]})]})}),s.jsx("div",{className:"app-content",children:e})]})]})}},25472:(e,a,t)=>{"use strict";t.d(a,{_:()=>s});let s=(0,t(47939).eI)("https://ueunqeqrvtuofpdoozye.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InVldW5xZXFydnR1b2ZwZG9venllIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTYxOTM4NjMsImV4cCI6MjA3MTc2OTg2M30.JY5i-uB5vZJ6enhWVgf9Bwg9bK2BFjmuXuOfjbQEQUw",{auth:{persistSession:!0,autoRefreshToken:!0}})},49418:(e,a,t)=>{"use strict";t.r(a),t.d(a,{$$typeof:()=>n,__esModule:()=>r,default:()=>l});var s=t(68570);let i=(0,s.createProxy)(String.raw`/Users/Aaron/Downloads/next-lipsync-app/app/auto-edit-beta/page.tsx`),{__esModule:r,$$typeof:n}=i;i.default;let l=(0,s.createProxy)(String.raw`/Users/Aaron/Downloads/next-lipsync-app/app/auto-edit-beta/page.tsx#default`)},98131:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>c,metadata:()=>o});var s=t(19510);t(67272);var i=t(68570);let r=(0,i.createProxy)(String.raw`/Users/Aaron/Downloads/next-lipsync-app/components/LayoutWrapper.tsx`),{__esModule:n,$$typeof:l}=r;r.default;let d=(0,i.createProxy)(String.raw`/Users/Aaron/Downloads/next-lipsync-app/components/LayoutWrapper.tsx#LayoutWrapper`),o={title:"Lipsync App",description:"Upload a video + audio and get back a lipsynced video using Sieve",viewport:"width=device-width, initial-scale=1"};function c({children:e}){return s.jsx("html",{lang:"en",children:s.jsx("body",{suppressHydrationWarning:!0,children:s.jsx(d,{children:e})})})}},67272:()=>{},4047:()=>{}};var a=require("../../webpack-runtime.js");a.C(e);var t=e=>a(a.s=e),s=a.X(0,[8948,7893,7939],()=>t(54592));module.exports=s})();