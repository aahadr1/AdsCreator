(()=>{var e={};e.id=268,e.ids=[268],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},85477:e=>{"use strict";e.exports=require("punycode")},12781:e=>{"use strict";e.exports=require("stream")},57310:e=>{"use strict";e.exports=require("url")},59796:e=>{"use strict";e.exports=require("zlib")},98811:(e,a,t)=>{"use strict";t.r(a),t.d(a,{GlobalError:()=>r.a,__next_app__:()=>u,originalPathname:()=>p,pages:()=>c,routeModule:()=>h,tree:()=>o}),t(88861),t(98131),t(35866);var s=t(23191),n=t(88716),i=t(37922),r=t.n(i),l=t(95231),d={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>l[e]);t.d(a,d);let o=["",{children:["enhance",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,88861)),"/Users/Aaron/Downloads/next-lipsync-app/app/enhance/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,98131)),"/Users/Aaron/Downloads/next-lipsync-app/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,35866,23)),"next/dist/client/components/not-found-error"]}],c=["/Users/Aaron/Downloads/next-lipsync-app/app/enhance/page.tsx"],p="/enhance/page",u={require:t,loadChunk:()=>Promise.resolve()},h=new s.AppPageRouteModule({definition:{kind:n.x.APP_PAGE,page:"/enhance/page",pathname:"/enhance",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},13376:(e,a,t)=>{Promise.resolve().then(t.bind(t,314))},97017:(e,a,t)=>{Promise.resolve().then(t.bind(t,20945))},9922:(e,a,t)=>{Promise.resolve().then(t.t.bind(t,12994,23)),Promise.resolve().then(t.t.bind(t,96114,23)),Promise.resolve().then(t.t.bind(t,9727,23)),Promise.resolve().then(t.t.bind(t,79671,23)),Promise.resolve().then(t.t.bind(t,41868,23)),Promise.resolve().then(t.t.bind(t,84759,23))},314:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>l});var s=t(10326);t(4047);var n=t(17577),i=t(25472),r=t(43120);function l(){let[e,a]=(0,n.useState)(""),[t,l]=(0,n.useState)(!1),[d,o]=(0,n.useState)("Low Resolution V2"),[c,p]=(0,n.useState)("4x"),[u,h]=(0,n.useState)(!0),[m,g]=(0,n.useState)("Foreground"),[x,f]=(0,n.useState)(.5),[v,j]=(0,n.useState)(!1),[y,b]=(0,n.useState)(null),[w,N]=(0,n.useState)(null),[_,k]=(0,n.useState)(null),S=(0,n.useCallback)(async e=>{let a=new FormData;a.append("file",e),a.append("filename",e.name);let t=await fetch("/api/upload",{method:"POST",body:a});if(!t.ok)throw Error(await t.text());return(await t.json()).url},[]);async function P(e){try{let a=await fetch("/api/persist",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:e,filename:e.split("/").pop()||null,folder:"enhance"})});if(!a.ok)return e;let t=await a.json();return"string"==typeof t?.url?t.url:e}catch{return e}}async function z(){j(!0),b(null),N(null);try{let{data:{user:a}}=await i._.auth.getUser();if(!a)throw Error("Please sign in at /auth before creating a task.");let t={image:e,enhance_model:d,upscale_factor:c,face_enhancement:u,subject_detection:m,face_enhancement_creativity:x},{data:s,error:n}=await i._.from("tasks").insert({user_id:a.id,type:"lipsync",status:"queued",provider:"replicate",model_id:"topazlabs/image-upscale",options_json:t,text_input:"enhance"}).select("*").single();if(n||!s)throw Error(n?.message||"Failed to create task");k(s.id);let r=await fetch("/api/enhance/run",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!r.ok)throw Error(await r.text());let l=await r.json();if(!l.url)throw Error("No image URL returned");let o=await P(l.url);N(o),s?.id&&await i._.from("tasks").update({status:"finished",output_url:o}).eq("id",s.id)}catch(e){b(e?.message||"Failed to enhance image"),_&&await i._.from("tasks").update({status:"error"}).eq("id",_)}finally{j(!1)}}return(0,s.jsxs)("div",{className:"container",children:[(0,s.jsxs)("div",{className:"panel output",children:[s.jsx("div",{className:"header",children:s.jsx("h2",{style:{margin:0},children:"Output"})}),s.jsx("div",{className:"outputArea",children:w?(0,s.jsxs)("div",{children:[s.jsx("img",{src:w,style:{maxWidth:"100%",borderRadius:8}}),s.jsx(r.Z,{mediaUrl:w,kind:"image",size:"large",context:{model:"topazlabs/image-upscale",prompt:"enhance",inputs:e?[{type:"image",url:e,label:"input"}]:void 0,extra:{enhance_model:d,upscale_factor:c,face_enhancement:u,subject_detection:m}}})]}):s.jsx("div",{style:{fontSize:16,color:"#b7c2df"},children:"Enhanced image will appear here."})}),y&&s.jsx("div",{className:"small",style:{color:"#ff7878"},children:y})]}),(0,s.jsxs)("div",{className:"panel",children:[s.jsx("div",{className:"header",children:s.jsx("h3",{style:{margin:0},children:"Inputs"})}),(0,s.jsxs)("div",{children:[s.jsx("div",{className:"small",children:"Input image"}),(0,s.jsxs)("div",{className:`dnd ${t?"drag":""}`,onDragOver:e=>{e.preventDefault(),l(!0)},onDragLeave:e=>{e.preventDefault(),l(!1)},onDrop:async e=>{e.preventDefault(),l(!1);let t=Array.from(e.dataTransfer.files||[]).filter(e=>e.type.startsWith("image/"));if(t.length)try{let e=await S(t[0]);a(e)}catch(e){b(e?.message||"Upload failed")}},onClick:()=>{let e=document.createElement("input");e.type="file",e.accept="image/*",e.onchange=async()=>{let t=Array.from(e.files||[]);if(t.length)try{let e=await S(t[0]);a(e)}catch(e){b(e?.message||"Upload failed")}},e.click()},children:[s.jsx("div",{style:{fontWeight:700},children:"Drop image or click to upload"}),s.jsx("div",{className:"small",children:"PNG/JPG/WebP"}),e&&(0,s.jsxs)("div",{className:"fileInfo",style:{marginTop:8},children:[s.jsx("img",{src:e,alt:"input",style:{maxWidth:240,borderRadius:8}}),s.jsx("div",{className:"small",style:{marginTop:6},children:s.jsx("a",{href:e,target:"_blank",rel:"noreferrer",children:"Open image"})})]})]}),e&&s.jsx("button",{className:"btn",style:{marginTop:8},onClick:()=>a(""),children:"Clear image"})]}),(0,s.jsxs)("div",{className:"options",style:{marginTop:12},children:[(0,s.jsxs)("div",{children:[s.jsx("div",{className:"small",children:"Enhance model"}),s.jsx("input",{className:"input",value:d,onChange:e=>o(e.target.value),placeholder:"Low Resolution V2"})]}),(0,s.jsxs)("div",{children:[s.jsx("div",{className:"small",children:"Upscale factor"}),(0,s.jsxs)("select",{className:"select",value:c,onChange:e=>p(e.target.value),children:[s.jsx("option",{value:"2x",children:"2x"}),s.jsx("option",{value:"4x",children:"4x"}),s.jsx("option",{value:"6x",children:"6x"})]})]}),(0,s.jsxs)("label",{className:"small",style:{display:"flex",gap:8,alignItems:"center"},children:[s.jsx("input",{type:"checkbox",checked:u,onChange:e=>h(e.target.checked)})," Face enhancement"]}),(0,s.jsxs)("div",{children:[s.jsx("div",{className:"small",children:"Subject detection"}),(0,s.jsxs)("select",{className:"select",value:m,onChange:e=>g(e.target.value),children:[s.jsx("option",{value:"Foreground",children:"Foreground"}),s.jsx("option",{value:"Background",children:"Background"}),s.jsx("option",{value:"Off",children:"Off"})]})]}),(0,s.jsxs)("div",{children:[s.jsx("div",{className:"small",children:"Face enhancement creativity"}),s.jsx("input",{className:"input",type:"number",step:.05,min:0,max:1,value:x,onChange:e=>f(parseFloat(e.target.value||"0"))})]})]}),s.jsx("button",{className:"btn",style:{marginTop:12},disabled:!e||v,onClick:z,children:v?"Enhancing…":"Enhance image"})]})]})}},43120:(e,a,t)=>{"use strict";t.d(a,{Z:()=>r});var s=t(10326),n=t(17577),i=t(25472);let r=function({mediaUrl:e,kind:a,context:t,size:r="default"}){let[l,d]=(0,n.useState)(!1),[o,c]=(0,n.useState)(!1),[p,u]=(0,n.useState)(null),[h,m]=(0,n.useState)("idle");async function g(){if(e){d(!0),u(null),c(!1);try{let{data:{user:s}}=await i._.auth.getUser();if(!s)throw Error("Please sign in at /auth to save assets.");let n=await i._.auth.getSession(),r=n.data.session?.access_token||"";m("pending");let l=await fetch("/api/assets/add",{method:"POST",headers:{"Content-Type":"application/json",Authorization:r?`Bearer ${r}`:""},body:JSON.stringify({url:e,kind:a,context:t})});if(!l.ok)throw Error(await l.text());c(!0),m("indexing");try{let e=await l.json(),a=e?.asset?.id;if(a){let e=setInterval(async()=>{try{let{data:t}=await i._.from("media_assets").select("status").eq("id",a).single(),s=t?.status||"pending";"ready"===s&&(m("ready"),clearInterval(e)),"error"===s&&(m("error"),clearInterval(e))}catch{}},2e3);setTimeout(()=>clearInterval(e),2e4)}else m("ready")}catch{m("ready")}}catch(e){u(e instanceof Error?e.message:"Failed to add to database")}finally{d(!1)}}}return(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8,marginTop:8},children:[s.jsx("button",{className:"btn",type:"button","aria-label":"Add this media to database",onClick:g,onKeyDown:e=>(function({event:e,onActivate:a}){("Enter"===e.key||" "===e.key)&&a()})({event:e,onActivate:g}),disabled:l,style:{padding:"large"===r?"12px 14px":"6px 10px",width:"large"===r?"100%":void 0,fontSize:"large"===r?16:void 0},children:l?"Saving to database…":o?"Saved ✓":"Save to database"}),"idle"!==h&&s.jsx("span",{className:"badge","aria-live":"polite",children:"pending"===h?"Pending":"indexing"===h?"Indexing":"ready"===h?"Ready":"error"===h?"Error":""}),p&&s.jsx("div",{className:"small",style:{color:"#ff7878"},children:p})]})}},20945:(e,a,t)=>{"use strict";t.d(a,{LayoutWrapper:()=>_});var s=t(10326);t(17577);var n=t(35047),i=t(29798),r=t(58775),l=t(36283),d=t(49758),o=t(71709),c=t(1572),p=t(56562),u=t(61584),h=t(87444),m=t(31540),g=t(88307),x=t(2634),f=t(71208),v=t(88319),j=t(66697),y=t(32691),b=t(88378);let w=[{href:"/",label:"Home",icon:s.jsx(i.Z,{size:18})},{href:"/lipsync-new",label:"+ New Lipsync",icon:s.jsx(r.Z,{size:18}),gradient:"linear-gradient(90deg, #6aa4ff, #ff9f43)"},{href:"/transcription/bulk",label:"+ Bulk Transcription",icon:s.jsx(l.Z,{size:18}),gradient:"linear-gradient(90deg, #ff9f43, #6aa4ff)"},{href:"/veo",label:"+ New Video",icon:s.jsx(d.Z,{size:18}),gradient:"linear-gradient(90deg, #a36bff, #6aa4ff)"},{href:"/image",label:"+ New Image",icon:s.jsx(o.Z,{size:18}),gradient:"linear-gradient(90deg, #42d392, #a36bff)"},{href:"/enhance",label:"+ New Enhance",icon:s.jsx(c.Z,{size:18}),gradient:"linear-gradient(90deg, #ffbd2e, #42d392)"},{href:"/tts",label:"+ New Text to Speech",icon:s.jsx(p.Z,{size:18}),gradient:"linear-gradient(90deg, #ffbd2e, #ff6b6b)"},{href:"/adscript",label:"+ New Ad Script",icon:s.jsx(u.Z,{size:18}),gradient:"linear-gradient(90deg, #6aa4ff, #ff9f43)"},{href:"/background-remove",label:"+ Remove Background",icon:s.jsx(h.Z,{size:18}),gradient:"linear-gradient(90deg, #42d392, #ff6b6b)"},{href:"/download",label:"+ TikTok Downloader",icon:s.jsx(m.Z,{size:18}),gradient:"linear-gradient(90deg, #1db954, #2b8a3e)"},{href:"/spy",label:"Spy Tool",icon:s.jsx(g.Z,{size:18}),gradient:"linear-gradient(90deg, #6aa4ff, #42d392)"},{href:"/editor",label:"Editor",icon:s.jsx(x.Z,{size:18}),gradient:"linear-gradient(90deg, #42d392, #a36bff)"},{href:"/auto-edit-beta",label:"+ Auto Edit Beta",icon:s.jsx(f.Z,{size:18}),gradient:"linear-gradient(90deg, #6aa4ff, #a36bff)"},{href:"/library",label:"Database",icon:s.jsx(v.Z,{size:18}),gradient:"linear-gradient(90deg, #1db954, #6aa4ff)"},{href:"/tasks",label:"Tasks",icon:s.jsx(j.Z,{size:18})},{href:"/auth",label:"Sign in / Up",icon:s.jsx(y.Z,{size:18})},{href:"#",label:"Settings (soon)",icon:s.jsx(b.Z,{size:18}),disabled:!0}];function N(){let e=(0,n.usePathname)();return(0,s.jsxs)("aside",{className:"sidebar",children:[s.jsx("div",{className:"sidebar-header",children:s.jsx("h1",{className:"sidebar-title",children:"Lipsync"})}),s.jsx("nav",{className:"sidebar-nav",children:w.map(a=>{let t=e===a.href,n=!!a.gradient;return(0,s.jsxs)("a",{href:a.href,className:`nav-item ${t?"nav-item-active":""} ${n?"nav-item-gradient":""} ${a.disabled?"nav-item-disabled":""}`,style:n?{background:a.gradient}:void 0,onClick:a.disabled?e=>e.preventDefault():void 0,title:a.label,children:[s.jsx("span",{className:"nav-item-icon",children:a.icon}),s.jsx("span",{className:"nav-item-label",children:a.label})]},a.href)})}),s.jsx("div",{className:"sidebar-footer",children:(0,s.jsxs)("div",{className:"sidebar-copyright",children:["\xa9 ",new Date().getFullYear()," Lipsync"]})})]})}function _({children:e}){return"/"===(0,n.usePathname)()?s.jsx(s.Fragment,{children:e}):(0,s.jsxs)("div",{className:"app-layout",children:[s.jsx(N,{}),(0,s.jsxs)("main",{className:"app-main",children:[s.jsx("div",{className:"app-header",children:(0,s.jsxs)("div",{className:"app-header-content",children:[s.jsx("div",{className:"app-tagline",children:"Build great lipsyncs."}),(0,s.jsxs)("div",{className:"app-user",children:[s.jsx("div",{className:"user-email",id:"user-email"}),s.jsx("div",{className:"user-avatar-small"})]})]})}),s.jsx("div",{className:"app-content",children:e})]})]})}},25472:(e,a,t)=>{"use strict";t.d(a,{_:()=>s});let s=(0,t(47939).eI)("https://ueunqeqrvtuofpdoozye.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InVldW5xZXFydnR1b2ZwZG9venllIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTYxOTM4NjMsImV4cCI6MjA3MTc2OTg2M30.JY5i-uB5vZJ6enhWVgf9Bwg9bK2BFjmuXuOfjbQEQUw",{auth:{persistSession:!0,autoRefreshToken:!0}})},88861:(e,a,t)=>{"use strict";t.r(a),t.d(a,{$$typeof:()=>r,__esModule:()=>i,default:()=>l});var s=t(68570);let n=(0,s.createProxy)(String.raw`/Users/Aaron/Downloads/next-lipsync-app/app/enhance/page.tsx`),{__esModule:i,$$typeof:r}=n;n.default;let l=(0,s.createProxy)(String.raw`/Users/Aaron/Downloads/next-lipsync-app/app/enhance/page.tsx#default`)},98131:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>c,metadata:()=>o});var s=t(19510);t(67272);var n=t(68570);let i=(0,n.createProxy)(String.raw`/Users/Aaron/Downloads/next-lipsync-app/components/LayoutWrapper.tsx`),{__esModule:r,$$typeof:l}=i;i.default;let d=(0,n.createProxy)(String.raw`/Users/Aaron/Downloads/next-lipsync-app/components/LayoutWrapper.tsx#LayoutWrapper`),o={title:"Lipsync App",description:"Upload a video + audio and get back a lipsynced video using Sieve",viewport:"width=device-width, initial-scale=1"};function c({children:e}){return s.jsx("html",{lang:"en",children:s.jsx("body",{suppressHydrationWarning:!0,children:s.jsx(d,{children:e})})})}},67272:()=>{},4047:()=>{}};var a=require("../../webpack-runtime.js");a.C(e);var t=e=>a(a.s=e),s=a.X(0,[8948,7893,7939],()=>t(98811));module.exports=s})();