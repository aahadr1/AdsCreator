(()=>{var e={};e.id=1045,e.ids=[1045],e.modules={2006:e=>{function t(e){var t=Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=2006,e.exports=t},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},25626:(e,t,r)=>{"use strict";r.r(t),r.d(t,{originalPathname:()=>g,patchFetch:()=>f,requestAsyncStorage:()=>l,routeModule:()=>c,serverHooks:()=>d,staticGenerationAsyncStorage:()=>m});var n={};r.r(n),r.d(n,{POST:()=>u});var i=r(49303),a=r(88716),o=r(60670),s=r(9185),p=r.n(s);async function u(e){try{let t=await e.json();if(!t||!t.audio_file||"string"!=typeof t.audio_file)return new Response("Missing required field: audio_file",{status:400});let r=process.env.REPLICATE_API_TOKEN;if(!r)return new Response("Server misconfigured: missing REPLICATE_API_TOKEN",{status:500});let n=new(p())({auth:r}),i={audio_file:t.audio_file};"string"==typeof t.language&&""!==t.language.trim()&&(i.language=t.language),"string"==typeof t.prompt&&""!==t.prompt.trim()&&(i.prompt=t.prompt),"number"==typeof t.temperature&&(i.temperature=Math.max(0,Math.min(1,t.temperature)));let a="";for await(let e of n.stream("openai/gpt-4o-transcribe",{input:i}))a+=String(e);let o=process.env.OPENAI_API_KEY,s=a;if(o&&s.trim().length>0)try{let e=await fetch("https://api.openai.com/v1/chat/completions",{method:"POST",headers:{Authorization:`Bearer ${o}`,"Content-Type":"application/json"},body:JSON.stringify({model:"gpt-4o-mini",messages:[{role:"system",content:"You are a helpful editor. Clean up ASR transcripts: fix punctuation, casing, and paragraphing without changing meaning."},{role:"user",content:s}],temperature:.2})});if(e.ok){let t=await e.json(),r=t?.choices?.[0]?.message?.content;"string"==typeof r&&""!==r.trim()&&(s=r.trim())}}catch(e){}return Response.json({text:s,raw:{length:a.length}})}catch(e){return new Response(`Error: ${e.message}`,{status:500})}}let c=new i.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/transcription/run/route",pathname:"/api/transcription/run",filename:"route",bundlePath:"app/api/transcription/run/route"},resolvedPagePath:"/Users/Aaron/Downloads/next-lipsync-app/app/api/transcription/run/route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:l,staticGenerationAsyncStorage:m,serverHooks:d}=c,g="/api/transcription/run/route";function f(){return(0,o.patchFetch)({serverHooks:d,staticGenerationAsyncStorage:m})}},49303:(e,t,r)=>{"use strict";e.exports=r(30517)}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[8948,9185],()=>r(25626));module.exports=n})();