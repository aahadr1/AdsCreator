(()=>{var e={};e.id=7629,e.ids=[7629],e.modules={2006:e=>{function s(e){var s=Error("Cannot find module '"+e+"'");throw s.code="MODULE_NOT_FOUND",s}s.keys=()=>[],s.resolve=s,s.id=2006,e.exports=s},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},33455:(e,s,t)=>{"use strict";t.r(s),t.d(s,{originalPathname:()=>g,patchFetch:()=>f,requestAsyncStorage:()=>l,routeModule:()=>p,serverHooks:()=>h,staticGenerationAsyncStorage:()=>m});var r={};t.r(r),t.d(r,{POST:()=>c,runtime:()=>u});var n=t(49303),i=t(88716),a=t(60670),o=t(9185),d=t.n(o);let u="nodejs";async function c(e){try{let s=process.env.REPLICATE_API_TOKEN;if(!s)return new Response("Server misconfigured: missing REPLICATE_API_TOKEN",{status:500});let t=new(d())({auth:s}),r=await e.json();if(!r||!Array.isArray(r.segments)||"object"!=typeof r.candidates)return new Response("Missing segments/candidates",{status:400});let n=r.segments.map((e,s)=>{let t=(r.candidates[e.id]||[]).slice(0,10).map(e=>({id:e.id,url:e.public_url,title:e.title,desc:e.description,score:e.score})).filter(Boolean);return{index:s,segment_id:e.id,text:e.text,desired:e.desired_rush_description||"",rush_ideas:Array.isArray(e.rush_ideas)?e.rush_ideas.slice(0,3):[],candidates:t}}),i=await t.run("meta/meta-llama-3-70b-instruct",{input:{prompt:`You are an expert UGC ads creative editor. Given segments of a script and candidate B-roll options per segment, consider each segment's three rush ideas (if provided) and desired rush description when choosing the best single candidate. Return JSON only with fields: items: [{ segment_id, chosen_asset_id, reason }]. Keep reasons concise (<= 1 sentence).

DATA (JSON):
${JSON.stringify(n)}

Return JSON for { items: [...] } only.`,max_tokens:1200,temperature:.1}}),a="string"==typeof i?i:Array.isArray(i)?i.join("\n"):JSON.stringify(i),o=a.indexOf("{"),u=a.lastIndexOf("}"),c=o>=0&&u>=0?a.slice(o,u+1):a,p={};try{p=JSON.parse(c)}catch{}let l=Array.isArray(p.items)?p.items:[];return Response.json({ok:!0,items:l})}catch(s){let e=s instanceof Error?s.message:"Internal error";return new Response(`Error: ${e}`,{status:500})}}let p=new n.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/sequence/choose/route",pathname:"/api/sequence/choose",filename:"route",bundlePath:"app/api/sequence/choose/route"},resolvedPagePath:"/Users/Aaron/Downloads/next-lipsync-app/app/api/sequence/choose/route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:l,staticGenerationAsyncStorage:m,serverHooks:h}=p,g="/api/sequence/choose/route";function f(){return(0,a.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:m})}},49303:(e,s,t)=>{"use strict";e.exports=t(30517)}};var s=require("../../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),r=s.X(0,[8948,9185],()=>t(33455));module.exports=r})();