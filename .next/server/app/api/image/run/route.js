(()=>{var e={};e.id=7903,e.ids=[7903],e.modules={2006:e=>{function t(e){var t=Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=2006,e.exports=t},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},43409:(e,t,r)=>{"use strict";r.r(t),r.d(t,{originalPathname:()=>c,patchFetch:()=>_,requestAsyncStorage:()=>l,routeModule:()=>m,serverHooks:()=>g,staticGenerationAsyncStorage:()=>f});var a={};r.r(a),r.d(a,{POST:()=>s});var o=r(49303),n=r(88716),p=r(60670),u=r(9185),i=r.n(u);async function s(e){try{let t=await e.json();if(!t||!t.prompt||"string"!=typeof t.prompt)return new Response("Missing required field: prompt",{status:400});let r=process.env.REPLICATE_API_TOKEN;if(!r)return new Response("Server misconfigured: missing REPLICATE_API_TOKEN",{status:500});let a=new(i())({auth:r}),o=new Set(["black-forest-labs/flux-kontext-max","google/nano-banana","black-forest-labs/flux-krea-dev"]).has(String(t.model||""))?String(t.model):"black-forest-labs/flux-kontext-max",n={prompt:t.prompt};"black-forest-labs/flux-kontext-max"===o?(n={prompt:t.prompt,aspect_ratio:t.aspect_ratio||"match_input_image",output_format:t.output_format||"png"},t.input_image&&(n.input_image=t.input_image),"number"==typeof t.seed&&(n.seed=t.seed),"boolean"==typeof t.prompt_upsampling&&(n.prompt_upsampling=t.prompt_upsampling),"number"==typeof t.safety_tolerance&&(n.safety_tolerance=t.safety_tolerance)):"google/nano-banana"===o?(n={prompt:t.prompt,output_format:t.output_format||"jpg"},Array.isArray(t.image_input)&&t.image_input.length>0&&(n.image_input=t.image_input)):"black-forest-labs/flux-krea-dev"===o&&(n={prompt:t.prompt,aspect_ratio:t.aspect_ratio||"1:1",output_format:t.output_format||"webp"},"number"==typeof t.seed&&(n.seed=t.seed),t.input_image&&(n.image=t.input_image),Array.isArray(t.image_input)&&t.image_input.length>0&&(n.image=t.image_input[0]),"number"==typeof t.guidance&&(n.guidance=t.guidance),"number"==typeof t.num_outputs&&(n.num_outputs=Math.min(4,Math.max(1,t.num_outputs))),"number"==typeof t.output_quality&&(n.output_quality=Math.min(100,Math.max(0,t.output_quality))));let p=await a.run(o,{input:n}),u=null;if(Array.isArray(p)&&p.length>0)for(let e of p){if("string"==typeof e){u=e;break}if(e&&"object"==typeof e){if("function"==typeof e.url){try{u=e.url()}catch{}if(u)break}if("string"==typeof e.url){u=e.url;break}}}if(!u&&p&&"object"==typeof p&&"url"in p&&"function"==typeof p.url)try{u=p.url()}catch{}return u||"string"!=typeof p||(u=p),!u&&p&&"string"==typeof p.url&&(u=p.url),Response.json({url:u,raw:p})}catch(e){return new Response(`Error: ${e.message}`,{status:500})}}let m=new o.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/image/run/route",pathname:"/api/image/run",filename:"route",bundlePath:"app/api/image/run/route"},resolvedPagePath:"/Users/Aaron/Downloads/next-lipsync-app/app/api/image/run/route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:l,staticGenerationAsyncStorage:f,serverHooks:g}=m,c="/api/image/run/route";function _(){return(0,p.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:f})}},49303:(e,t,r)=>{"use strict";e.exports=r(30517)}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[8948,9185],()=>r(43409));module.exports=a})();