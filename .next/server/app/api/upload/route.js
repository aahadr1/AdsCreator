"use strict";(()=>{var e={};e.id=5998,e.ids=[5998],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},13685:e=>{e.exports=require("http")},95687:e=>{e.exports=require("https")},85477:e=>{e.exports=require("punycode")},12781:e=>{e.exports=require("stream")},57310:e=>{e.exports=require("url")},59796:e=>{e.exports=require("zlib")},40721:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>g,patchFetch:()=>f,requestAsyncStorage:()=>c,routeModule:()=>l,serverHooks:()=>m,staticGenerationAsyncStorage:()=>d});var s={};r.r(s),r.d(s,{POST:()=>u,runtime:()=>p});var a=r(49303),o=r(88716),n=r(60670),i=r(69498);let p="nodejs";async function u(e){try{let t=process.env.SUPABASE_URL||"https://ueunqeqrvtuofpdoozye.supabase.co",r=process.env.SUPABASE_SERVICE_ROLE_KEY||"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InVldW5xZXFydnR1b2ZwZG9venllIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTYxOTM4NjMsImV4cCI6MjA3MTc2OTg2M30.JY5i-uB5vZJ6enhWVgf9Bwg9bK2BFjmuXuOfjbQEQUw",s=process.env.SUPABASE_BUCKET||"inputs",a="true"===(process.env.SUPABASE_BUCKET_PUBLIC||"true").toLowerCase();if(!t||!r)return new Response("Server misconfigured: missing SUPABASE_URL/SUPABASE_SERVICE_ROLE_KEY",{status:500});let o=await e.formData(),n=o.get("file"),p=o.get("filename");if(!n||!(n instanceof Blob))return new Response("No file provided",{status:400});let u=(0,i.eI)(t,r,{auth:{persistSession:!1}});try{let{data:e}=await u.storage.getBucket(s);e||await u.storage.createBucket(s,{public:a})}catch(e){}let l="string"==typeof n.name?n.name.split(".").pop():(p||"bin").split(".").pop(),c=(p||("string"==typeof n.name?n.name:`upload.${l}`)).replace(/[^a-zA-Z0-9_.-]/g,"_"),d=`inputs/${Date.now()}-${c}`,m=await n.arrayBuffer(),g=n.type||"application/octet-stream",{error:f}=await u.storage.from(s).upload(d,new Uint8Array(m),{upsert:!1,cacheControl:"3600",contentType:g});if(f)return new Response(`Upload failed: ${f.message}`,{status:500});if(a){let{data:e}=u.storage.from(s).getPublicUrl(d);return Response.json({url:e.publicUrl,path:d})}{let{data:e,error:t}=await u.storage.from(s).createSignedUrl(d,3600);if(t)return new Response(`Signed URL failed: ${t.message}`,{status:500});return Response.json({url:e.signedUrl,path:d})}}catch(e){return new Response(`Error: ${e.message}`,{status:500})}}let l=new a.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/upload/route",pathname:"/api/upload",filename:"route",bundlePath:"app/api/upload/route"},resolvedPagePath:"/Users/Aaron/Downloads/next-lipsync-app/app/api/upload/route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:c,staticGenerationAsyncStorage:d,serverHooks:m}=l,g="/api/upload/route";function f(){return(0,n.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:d})}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[8948,2659,9498],()=>r(40721));module.exports=s})();