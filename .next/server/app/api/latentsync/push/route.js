"use strict";(()=>{var e={};e.id=5824,e.ids=[5824],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},58582:(e,t,s)=>{s.r(t),s.d(t,{originalPathname:()=>h,patchFetch:()=>T,requestAsyncStorage:()=>d,routeModule:()=>c,serverHooks:()=>E,staticGenerationAsyncStorage:()=>f});var n={};s.r(n),s.d(n,{POST:()=>l});var r=s(49303),a=s(88716),i=s(60670);let o="https://api.replicate.com/v1",u=[process.env.REPLICATE_LATENTSYNC_MODEL,"bytedance/latentsync"].filter(Boolean);async function p(e,t){let s=await fetch(`${o}/models/${e}/versions?limit=1`,{headers:{Authorization:`Bearer ${t}`}});if(!s.ok)return null;let n=await s.json();return n?.results?.[0]?.id||n?.versions?.[0]?.id||null}async function l(e){try{let{videoUrl:t,audioUrl:s,options:n}=await e.json()||{};if(!t||!s)return new Response("Missing videoUrl/audioUrl",{status:400});let r=process.env.REPLICATE_API_TOKEN;if(!r)return new Response("Server misconfigured: missing REPLICATE_API_TOKEN",{status:500});let a=process.env.REPLICATE_LATENTSYNC_VERSION||null;if(!a)for(let e of u){let t=await p(e,r);if(t){a=t;break}}if(!a)return new Response("LatentSync model not found on Replicate. Set REPLICATE_LATENTSYNC_VERSION or REPLICATE_LATENTSYNC_MODEL.",{status:500});let i={version:a,input:{video:t,audio:s}};n?.inference_steps&&(i.input.inference_steps=n.inference_steps),n?.guidance_scale&&(i.input.guidance_scale=n.guidance_scale);let l=await fetch(`${o}/predictions`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`},body:JSON.stringify(i)}),c=await l.text();if(!l.ok)return new Response(c,{status:l.status});let d=JSON.parse(c);return Response.json({id:d.id,status:d.status})}catch(e){return new Response(`Error: ${e.message}`,{status:500})}}let c=new r.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/latentsync/push/route",pathname:"/api/latentsync/push",filename:"route",bundlePath:"app/api/latentsync/push/route"},resolvedPagePath:"/Users/Aaron/Downloads/next-lipsync-app/app/api/latentsync/push/route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:d,staticGenerationAsyncStorage:f,serverHooks:E}=c,h="/api/latentsync/push/route";function T(){return(0,i.patchFetch)({serverHooks:E,staticGenerationAsyncStorage:f})}},49303:(e,t,s)=>{e.exports=s(30517)}};var t=require("../../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),n=t.X(0,[8948],()=>s(58582));module.exports=n})();