"use strict";(()=>{var e={};e.id=8011,e.ids=[8011],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},34264:(e,t,o)=>{o.r(t),o.d(t,{originalPathname:()=>m,patchFetch:()=>w,requestAsyncStorage:()=>l,routeModule:()=>d,serverHooks:()=>h,staticGenerationAsyncStorage:()=>u});var r={};o.r(r),o.d(r,{GET:()=>c,dynamic:()=>p,runtime:()=>i});var n=o(49303),s=o(88716),a=o(60670);let i="nodejs",p="force-dynamic";async function c(e){try{let{searchParams:t}=new URL(e.url),o=t.get("url"),r=(t.get("type")||"").toLowerCase(),n="true"===(t.get("download")||"").toLowerCase();if(!o||(!o&&e.headers.get("x-target-url")&&(o=e.headers.get("x-target-url")||null),!o))return new Response("Missing url",{status:400});try{for(;/%2F|%3A/i.test(o);){let e=decodeURIComponent(o);if(e===o)break;o=e}}catch{}if(!/^https?:\/\//i.test(String(o)))return new Response("Invalid url",{status:400});let s=e.headers.get("range")||void 0,a=new URL(String(o)),i=a.hostname.toLowerCase(),p=/(^|\.)tikwm\.com$/i.test(i)||/(^|\.)tikcdn\./i.test(i),c=/tiktok|bytecdn|ttwcdn|tiktokcdn|tiktokv/i.test(i),d={"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0 Safari/537.36",Accept:"*/*",Connection:"keep-alive"};s&&(d.Range=s),p?(d.Referer="https://www.tikwm.com/",d.Origin="https://www.tikwm.com"):c&&(d.Referer="https://www.tiktok.com/",d.Origin="https://www.tiktok.com");let l=await fetch(o,{cache:"no-store",headers:Object.keys(d).length?d:void 0}).catch(e=>{throw Error(`Upstream fetch error: ${e?.message||"unknown error"}`)});if(!l.ok||!l.body||l.status>=400&&206!==l.status)try{let e={...d};delete e.Range,l=await fetch(o,{cache:"no-store",headers:Object.keys(e).length?e:void 0})}catch{}if(!l.ok||!l.body){let e=await l.text().catch(()=>"");return new Response(e||"Upstream fetch failed",{status:l.status||502})}let u=l.headers.get("content-type")||"",h=a.pathname.toLowerCase();!u&&("video"===r||h.endsWith(".mp4"))&&(u="video/mp4");let m={"Content-Type":u||"application/octet-stream","Cache-Control":"no-store","Content-Disposition":"inline"};for(let e of["etag","last-modified","content-length","accept-ranges","content-range"]){let t=l.headers.get(e);t&&(m[e.split("-").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join("-")]=t)}if(!m["Accept-Ranges"]&&("video"===r||h.endsWith(".mp4"))&&(m["Accept-Ranges"]="bytes"),n){let e=a.pathname.split("/").pop()||"download";m["Content-Disposition"]=`attachment; filename="${e}"`}else m["Content-Disposition"]="inline";return new Response(l.body,{status:l.status,headers:m})}catch(e){return new Response(`Error: ${e.message}`,{status:500})}}let d=new n.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/proxy/route",pathname:"/api/proxy",filename:"route",bundlePath:"app/api/proxy/route"},resolvedPagePath:"/Users/Aaron/Downloads/next-lipsync-app/app/api/proxy/route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:l,staticGenerationAsyncStorage:u,serverHooks:h}=d,m="/api/proxy/route";function w(){return(0,a.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:u})}},49303:(e,t,o)=>{e.exports=o(30517)}};var t=require("../../../webpack-runtime.js");t.C(e);var o=e=>t(t.s=e),r=t.X(0,[8948],()=>o(34264));module.exports=r})();